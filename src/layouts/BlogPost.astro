---
import BaseLayout from "./BaseLayout.astro";
import Navigation from "../components/navigation/navigation";

const { frontmatter = {} } = Astro.props;
const {
  title = "Untitled",
  description = "",
  date,
  tags = [],
  hero,
} = frontmatter;

const pageTitle = `${title} | Sinisa Mikulic`;
const pageDescription = description;

const fmt = (d: any) =>
  new Date(d).toLocaleDateString("en-GB", {
    year: "numeric",
    month: "short",
    day: "2-digit",
  });
---

<BaseLayout title={pageTitle} description={pageDescription} ogImage={hero} isArticle={true}>
  {/* Inject article-specific tags into BaseLayout's <slot name="head" /> */}
  <Fragment slot="head">
    <meta
      property="article:published_time"
      content={date ? date : ""}
    />
    <script type="application/ld+json" is:inline>
      {JSON.stringify({
        "@context": "https://schema.org",
        "@type": "BlogPosting",
        headline: title,
        description: pageDescription,
        datePublished: date ? date.toISOString() : undefined,
        mainEntityOfPage: pageUrl,
      })}
    </script>
  </Fragment>

  <main class="container">
    <Navigation />

    <div class="section section-page">
      <h1>{title}</h1>
      <small style="margin-bottom:1rem;color:#666;">{fmt(date)}</small>
      {
        Array.isArray(tags) && tags.length > 0 && (
          <div class="tech">
            {tags.map((tag) => (
              <span>{tag}</span>
            ))}
          </div>
        )
      }
    <article>
      <header style="margin-bottom:2.5rem;">
        {
          hero && (
            <div style="margin-top:1rem;">
              <img
                src={hero}
                alt={title}
                style="width:100%;height:auto;border-radius:.5rem;"
              />
            </div>
          )
        }
      </header>

      <slot />
      
      <p style="margin-top:1rem;"><a href="/blog">‚Üê Back to Writing</a></p>
    </article>
    </div>
  </main>
</BaseLayout>
